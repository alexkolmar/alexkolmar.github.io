<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Конвертер символов</title>
    <!-- Подключаем библиотеку he -->
    <script src="https://alexkolmar.github.io/04-scripts/he.js"></script>
    <style>
        body { font-family: Arial, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; }
        textarea, .output { width: 100%; padding: 10px; margin-bottom: 10px; }
        button { background: #4CAF50; color: white; border: none; padding: 10px; cursor: pointer; }
        button:hover { background: #45a049; }
        .output { background: #f4f4f4; border: 1px solid #ddd; white-space: pre-wrap; }
    </style>
</head>
<body>
    <h1>Конвертер символов</h1>
    
    <label for="inputText">Введите текст:</label>
    <textarea id="inputText" rows="4" placeholder="Например: — «Привет» © ♥"></textarea>
    
    <button onclick="convertToHtml()">→ HTML-сущности</button>
    <div class="output" id="htmlOutput"></div>
    
    <button onclick="convertToUnicode()">→ 16-ричный код (для CSS/JS)</button>
    <div class="output" id="unicodeOutput"></div>

    <script>
        // Проверка загрузки библиотеки
        if (typeof he === 'undefined') {
            console.error("Ошибка: библиотека 'he' не загружена!");
            alert("Библиотека 'he' не загружена. Проверьте консоль (F12).");
        }

        // Конвертация в HTML-сущности через he
        function convertToHtml() {
            const input = document.getElementById("inputText").value;
            try {
                const output = he.encode(input, {
                    useNamedReferences: true,  // Используем &mdash; вместо &#8212;
                    allowUnsafeSymbols: true   // Не кодирует <, >, & без необходимости
                });
                document.getElementById("htmlOutput").textContent = output;
            } catch (e) {
                console.error("Ошибка в convertToHtml:", e);
                document.getElementById("htmlOutput").textContent = "Ошибка конвертации. Подробности в консоли.";
            }
        }

        // Конвертация в 16-ричные коды (для CSS/JS)
        function convertToUnicode() {
            const input = document.getElementById("inputText").value;
            let output = '';
            for (const char of input) {
                // Пропускаем русские/английские буквы, цифры и пробелы
                if (/[а-яА-ЯёЁa-zA-Z0-9\s]/.test(char)) {
                    output += char;
                } else {
                    const hex = char.charCodeAt(0).toString(16).toUpperCase().padStart(4, '0');
                    output += '\\' + hex + ' ';
                }
            }
            document.getElementById("unicodeOutput").textContent = output.trim();
        }
    </script>
</body>
</html>